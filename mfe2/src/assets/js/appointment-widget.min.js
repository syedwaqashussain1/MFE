'use strict';
(function () {
  var widget = document.getElementById('nf-appointment-widget');
  var widgetId = widget.getAttribute('value');
  var subdomain = widget.getAttribute('widget');
  var env = widget.getAttribute('env');
  var i = document.createElement('iframe');
  if (env === 'local') {
    i.src = 'http://localhost:4200/embed/service-appointment/' + widgetId + '/customer';
  } else {
    i.src = 'https://' + subdomain + '.nightfax.com/embed/service-appointment/' + widgetId + '/customer';
  }

  i.id = 'nf-appointment-frame';
  var scr = document.getElementById('nf-appointment-widget');
  scr.parentNode.insertBefore(i, scr.nextSibling)
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.src = 'https://s3.us-west-1.amazonaws.com/nightfax.com/js/iframeResizer.min.js';
  document.head.appendChild(s);
  document.head.insertAdjacentHTML("beforeend", `<style>iframe#nf-appointment-frame{width: 1px;min-width: 100%;border: none;}</style>`)

  s.onload = function () {
    console.log('ONLOAD-----------------')
    iFrameResize({
      checkOrigin: false,
      autoResize: true,
      /*log: true,*/
      scrolling: false,
      sizeWidth: true,
      //enablePublicMethods: true,                  // Enable methods within iframe hosted page
      //heightCalculationMethod: 'lowestElement',
    }, '#nf-appointment-frame')
  }


})();

